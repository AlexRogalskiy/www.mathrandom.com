FROM node:14

ARG SENDGRID_API_KEY
ARG MAIN_LIST_ID

ARG RECAPTCHA_SITE_KEY
ARG RECAPTCHA_SECRET_KEY

ARG IMAGEKIT_PUBLIC_KEY
ARG IMAGEKIT_PRIVATE_KEY
ARG IMAGEKIT_URL_ENDPOINT

WORKDIR /usr/src/app

COPY . ./
RUN yarn

EXPOSE 3000

ENV HOST=0.0.0.0
ENV PORT=3000

RUN yarn build
RUN yarn generate

CMD [ "yarn", "start" ]
